# TO DO：

- [ ] 实现并发进行多个任务
- [ ] 摄像头调用部分改写，多个摄像头，后台直接统一控制开启，与现在的网页前端分离
- [ ] 前端界面修改，只保留上传图片和下载视频的界面，做手机界面适配
- [ ] 云服务器部署



正在做：

新增：

- [ ] 实现并发进行多个任务

完善：

- [ ] 解决界面刷新后图片和视频会被清除的问题
- [ ] 拆分app.py代码

bug：

- [ ] 前端摄像头突然打不开了









# 流程

初始化：

- 配置ffmpeg路径
- 创建face_extractor实例（用于录制视频后提取特征存储）
- 创建visitor_detector实例（用于检测画面中的游客）

- condition（录制的触发条件）
- target_embedding->target_feature（为每个上传的任务创建一个）：根据上传人脸图像检索视频时提取的特征
- 初始化景区数量









- **Flask**（主进程）：接收请求 → 把任务丢到 Redis
- **Celery Worker**（多个进程）：消费任务 → 运行检测/合成
- **线程**：如果有多个摄像头输入，可以在 Worker 内部开线程来读取

实现：

- 多用户同时发请求不阻塞
- 多路摄像头同时处理
- 多个视频合成同时进行



config.py

> 用于初始化

- ffmpeg路径
- 人脸识别阈值
- 录制条件参数
- 景点列表
- 路径配置
- 存储目录